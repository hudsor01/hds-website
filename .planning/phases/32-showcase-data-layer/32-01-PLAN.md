---
phase: 32-showcase-data-layer
plan: 01
type: execute
---

<objective>
Migrate case_studies data to projects table and create unified showcase data layer.

Purpose: Move existing case study content into the projects table with showcaseType='detailed', then create a unified data layer for the showcase route.
Output: All case studies migrated to projects, unified showcase.ts data layer created.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@src/lib/schema/projects.ts
@src/lib/schema/content.ts
@src/lib/case-studies.ts
@src/lib/projects.ts

**Prerequisite:** Phase 31 complete (schema has new fields)

**Data migration mapping:**
case_studies → projects:
- slug → slug
- title → title
- clientName → clientName (NEW)
- industry → industry
- projectType → projectType (NEW)
- description → description
- challenge → challenge (NEW, text narrative)
- solution → solution (NEW, text narrative)
- results → results (NEW, text narrative)
- technologies → technologies
- metrics → stats (convert format)
- testimonial* → testimonial*
- thumbnailUrl → imageUrl
- featuredImageUrl → ogImageUrl
- projectUrl → externalLink
- projectDuration → projectDuration
- teamSize → teamSize
- featured → featured
- published → published
- showcaseType → 'detailed' (NEW)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create data migration script</name>
  <files>scripts/migrate-case-studies-to-projects.ts</files>
  <action>
Create a migration script that:
1. Fetches all records from case_studies table
2. Maps each record to projects table format
3. Sets showcaseType = 'detailed' for all migrated records
4. Inserts into projects table (upsert by slug to avoid duplicates)
5. Logs migration results

Handle field mapping:
- metrics array [{label, value}] → stats object {label: value}
- Preserve all testimonial data
- Set appropriate defaults for missing fields
  </action>
  <verify>Script runs without errors: bun run scripts/migrate-case-studies-to-projects.ts</verify>
  <done>Migration script created and tested</done>
</task>

<task type="auto">
  <name>Task 2: Run migration and verify data</name>
  <files>None (data operation)</files>
  <action>
1. Run the migration script
2. Verify migrated records exist in projects table
3. Verify showcaseType is set correctly
4. Verify no data loss from case_studies fields

Query to verify:
SELECT slug, showcase_type, client_name, challenge FROM projects WHERE showcase_type = 'detailed';
  </action>
  <verify>All case studies exist in projects table with showcaseType='detailed'</verify>
  <done>Data migrated successfully</done>
</task>

<task type="auto">
  <name>Task 3: Create unified showcase data layer</name>
  <files>src/lib/showcase.ts</files>
  <action>
Create src/lib/showcase.ts with:

1. ShowcaseItem interface (extends Project with type awareness)
2. getShowcaseItems() - returns all published projects
3. getShowcaseItemBySlug(slug) - returns single item
4. getDetailedShowcaseItems() - returns only showcaseType='detailed'
5. getQuickShowcaseItems() - returns only showcaseType='quick'
6. getFeaturedShowcaseItems() - returns featured items

Use the projects table and mapProject from projects.ts.
Add helper to determine if item is detailed (for UI rendering).
  </action>
  <verify>bun run typecheck passes</verify>
  <done>Unified showcase data layer created</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] Migration script runs successfully
- [ ] All case_studies records exist in projects table
- [ ] showcaseType correctly set ('detailed' for migrated, 'quick' for existing)
- [ ] showcase.ts created with all query functions
- [ ] `bun run typecheck` passes
- [ ] `bun run build` succeeds
</verification>

<success_criteria>
- All case studies migrated to projects table
- Unified showcase.ts data layer works
- Both quick and detailed items queryable
- Ready for route creation in Phase 33
</success_criteria>

<output>
After completion, create `.planning/phases/32-showcase-data-layer/32-01-SUMMARY.md`
</output>
