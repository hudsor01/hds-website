---
phase: 31-showcase-schema-migration
plan: 01
type: execute
---

<objective>
Extend projects schema with case-study fields to support unified showcase.

Purpose: Add fields needed to store detailed case study content in the projects table, enabling a unified showcase that can display both quick portfolio items and detailed case studies.
Output: Updated Drizzle schema with new fields, migration generated and applied.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@src/lib/schema/projects.ts
@src/lib/schema/content.ts

**Current projects schema has:**
- slug, title, description, longDescription
- category, techStack, technologies, imageUrl
- stats (jsonb), resultsMetrics, challenges (array), solutions (array)
- testimonial fields, industry, projectDuration, teamSize
- featured, published, displayOrder

**Missing fields needed from case_studies:**
- showcaseType: 'quick' | 'detailed' - to distinguish portfolio items from case studies
- clientName: text - who the client is
- projectType: text - type of project (website, app, etc.)
- challenge: text - narrative challenge description (case_studies has this)
- solution: text - narrative solution description
- results: text - narrative results description
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add new fields to projects schema</name>
  <files>src/lib/schema/projects.ts</files>
  <action>
Add the following fields to the projects table schema:

```typescript
// After existing fields, before timestamps:
showcaseType: text('showcase_type').default('quick'), // 'quick' | 'detailed'
clientName: text('client_name'),
projectType: text('project_type'),
challenge: text('challenge'), // Narrative text (different from challenges array)
solution: text('solution'),   // Narrative text (different from solutions array)
results: text('results'),     // Narrative text
```

Update the type exports to include these new fields.
  </action>
  <verify>bun run typecheck passes</verify>
  <done>Schema updated with 6 new fields for showcase unification</done>
</task>

<task type="auto">
  <name>Task 2: Generate and apply Drizzle migration</name>
  <files>drizzle/migrations/</files>
  <action>
Generate migration with drizzle-kit:
1. Run: bunx drizzle-kit generate
2. Review the generated migration SQL
3. Run: bunx drizzle-kit migrate (or push for development)

The migration should add columns:
- showcase_type (text, default 'quick')
- client_name (text, nullable)
- project_type (text, nullable)
- challenge (text, nullable)
- solution (text, nullable)
- results (text, nullable)
  </action>
  <verify>
bunx drizzle-kit push --dry-run shows no pending changes
OR migration file exists in drizzle/migrations/
  </verify>
  <done>Migration generated and applied, database schema updated</done>
</task>

<task type="auto">
  <name>Task 3: Update projects data layer types</name>
  <files>src/lib/projects.ts</files>
  <action>
Update the Project interface and mapProject function to include new fields:

Add to interface:
- showcase_type: string;
- client_name: string | null;
- project_type: string | null;
- challenge: string | null;
- solution: string | null;
- results: string | null;

Add to mapProject:
- showcase_type: row.showcaseType ?? 'quick',
- client_name: row.clientName,
- project_type: row.projectType,
- challenge: row.challenge,
- solution: row.solution,
- results: row.results,
  </action>
  <verify>bun run typecheck passes</verify>
  <done>Data layer updated with new fields</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `bun run typecheck` passes
- [ ] `bun run build` succeeds
- [ ] New fields exist in projects table (check via SQL or drizzle studio)
- [ ] No breaking changes to existing portfolio functionality
</verification>

<success_criteria>
- Schema extended with showcase fields
- Migration applied to database
- Data layer types updated
- Existing portfolio still works
- Ready for data migration in Phase 32
</success_criteria>

<output>
After completion, create `.planning/phases/31-showcase-schema-migration/31-01-SUMMARY.md`
</output>
